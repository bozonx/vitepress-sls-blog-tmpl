# Канонические ссылки (Canonical Links)

## Описание

Канонические ссылки помогают поисковым системам понять, какая версия страницы является основной, что помогает избежать проблем с дублированным контентом.

## Использование

Чтобы добавить каноническую ссылку на страницу, добавьте параметр `canonical` в frontmatter:

**Поддерживаемые форматы:**

- `canonical: "https://example.com/en/post/post-slug"` (полный URL)
- `canonical: "self"` (ссылка на саму страницу)
- `canonical: "s"` (сокращенная версия "self")

```yaml
---
title: My Post Title
description: Post description
date: 2024-01-15
canonical: "https://example.com/en/post/post-slug"  # URL канонической страницы
# или
canonical: "self"  # Ссылка на саму страницу
# или
canonical: "s"     # Сокращенная версия
tags:
  - tag1
  - tag2
---
```

## Что происходит

### С указанным URL

Когда параметр `canonical` установлен с URL:

1. Трансформер `addCanonicalLink` автоматически добавляет тег в head страницы
2. Используется указанный URL как каноническая ссылка
3. Добавляется тег: `<link rel="canonical" href="https://example.com/en/post/post-slug">`

### С self/s

Когда параметр `canonical` установлен как `"self"` или `"s"`:

1. Трансформер автоматически генерирует URL текущей страницы
2. Используется сгенерированный URL как каноническая ссылка
3. Добавляется тег: `<link rel="canonical" href="https://example.com/en/post/current-page">`

## Примеры

### С канонической ссылкой на другую страницу

```yaml
---
title: 'Как настроить VitePress'
description: 'Пошаговое руководство по настройке VitePress'
date: 2024-01-15
canonical: 'https://example.com/en/post/how-to-setup-vitepress'
---
```

Результат в HTML:

```html
<link
  rel="canonical"
  href="https://example.com/en/post/how-to-setup-vitepress"
/>
```

### С канонической ссылкой на саму страницу

```yaml
---
title: 'Страница с self canonical'
description: 'Ссылка на саму страницу'
date: 2024-01-15
canonical: 'self'
---
```

Результат в HTML:

```html
<link rel="canonical" href="https://example.com/en/post/current-page" />
```

### С сокращенной версией

```yaml
---
title: 'Страница с s canonical'
description: 'Сокращенная версия self'
date: 2024-01-15
canonical: 's'
---
```

Результат в HTML (тот же, что и с `"self"`):

```html
<link rel="canonical" href="https://example.com/en/post/current-page" />
```

### Без канонической ссылки

```yaml
---
title: 'Обычная страница'
description: 'Страница без канонической ссылки'
date: 2024-01-15
---
```

Результат: каноническая ссылка не добавляется.

## Технические детали

- Трансформер работает только для страниц с языковым префиксом (например, `/en/`, `/ru/`)
- Корневые страницы (`index.md`) пропускаются
- URL должен быть валидным (проверяется автоматически)
- Функция безопасно обрабатывает ошибки и логирует предупреждения
- Значения `"self"` и `"s"` автоматически генерируют URL текущей страницы
- При использовании `"self"` или `"s"` требуется настройка `hostname` в конфигурации

## Когда использовать

### `canonical: "URL"`

- Основные страницы постов
- Страницы с важным контентом
- Страницы, которые могут быть доступны по разным URL
- Страницы с дублированным контентом (указывать на оригинальную страницу)

### `canonical: "self"` или `canonical: "s"`

- Страницы, которые должны указывать на себя как на каноническую версию
- Основные версии страниц
- Страницы, которые не являются дубликатами других страниц

## Примечания

- Каноническая ссылка указывает на указанный URL или на текущую страницу
- Это помогает поисковым системам понять, какая версия страницы является основной
- Используйте `"self"` или `"s"` для указания на саму страницу
- Используйте полный URL для указания на другую страницу
- URL должен быть абсолютным (с протоколом и доменом)
- Значения `"self"` и `"s"` эквивалентны
