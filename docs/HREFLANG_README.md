# Hreflang Meta Tags для VitePress SLS Blog Template

## Описание

Функция `addHreflang` автоматически добавляет метатеги hreflang в head страницы для улучшения SEO и многоязычности. Она генерирует ссылки на эту же страницу на всех доступных языках.

## Что делает функция

1. **Анализирует путь страницы** - извлекает языковой префикс и путь страницы
2. **Генерирует URL для других языков** - создает ссылки на эту же страницу на других доступных языках
3. **Добавляет метатеги в head** - вставляет `<link rel="alternate" hreflang="..." href="..." />` теги
4. **Исключает root язык** - не добавляет hreflang для root локали
5. **Не дублирует текущий язык** - не добавляет ссылку на текущий язык страницы

## Генерируемые метатеги

Для русской страницы `ru/index.md` генерируются:

```html
<!-- Другие языки -->
<link rel="alternate" hreflang="en-US" href="https://example.com/en/index" />

<!-- x-default (основной язык) -->
<link
  rel="alternate"
  hreflang="x-default"
  href="https://example.com/en/index"
/>
```

**Важно**: Ссылка на текущий язык НЕ добавляется, так как это не нужно для hreflang.

## Конфигурация

### Требования

1. **Hostname** - должен быть указан в конфигурации блога
2. **Многоязычность** - должно быть настроено минимум 2 языка
3. **Структура файлов** - файлы должны иметь языковой префикс в пути

### Пример конфигурации

```javascript
// В конфигурации VitePress
export default defineConfig({
  ...configBase,
  locales: { en: { lang: 'en-US' }, ru: { lang: 'ru-RU' } },
})

// В PROPS.js
export const PROPS = { hostname: 'https://example.com' }
```

## Структура файлов

Функция ожидает следующую структуру файлов:

```
src/
├── en/
│   ├── post/
│   │   └── article.md
│   └── page/
│       └── about.md
└── ru/
    ├── post/
    │   └── article.md
    └── page/
        └── about.md
```

## Обработка различных типов страниц

### Посты

- **Путь**: `en/post/article.md`
- **URL**: `https://example.com/en/post/article`

### Страницы

- **Путь**: `en/page/about.md`
- **URL**: `https://example.com/en/page/about`

### Главная страница

- **Путь**: `en/index.md`
- **URL**: `https://example.com/en`

## Логика работы

1. **Проверка входных данных** - проверяет наличие filePath и hostname
2. **Извлечение языка** - получает текущий язык из пути файла
3. **Фильтрация языков** - исключает root и текущий язык
4. **Генерация путей** - создает пути для других доступных языков
5. **Очистка путей** - убирает расширения файлов и индексы
6. **Добавление метатегов** - вставляет hreflang теги в frontmatter.head

## Особенности реализации

### Исключение root языка

Функция автоматически исключает `root` локаль из hreflang метатегов, так как это техническая локаль VitePress.

### Отсутствие ссылки на текущий язык

Hreflang метатеги не должны содержать ссылку на текущий язык страницы - это избыточно и может вызвать путаницу.

### x-default hreflang

`x-default` указывает на основной язык сайта (обычно английский) и используется поисковыми системами для определения языка по умолчанию.

## Обработка ошибок

Функция корректно обрабатывает следующие случаи:

- ✅ **Корректные страницы** - добавляет все необходимые метатеги
- ✅ **Отсутствие hostname** - пропускает страницу
- ✅ **Корневые страницы** - пропускает страницы без языкового префикса
- ✅ **Один язык** - пропускает страницы с одним языком
- ✅ **Root локаль** - исключает root из hreflang
- ✅ **Текущий язык** - не дублирует ссылку на текущий язык
- ✅ **Некорректные пути** - безопасно обрабатывает различные форматы путей

## Интеграция

Функция автоматически вызывается в `transformPageData` и не требует дополнительной настройки:

```javascript
transformPageData(pageData, ctx) {
  resolveDescription(pageData, ctx)
  transformPageMeta(pageData, ctx)
  addOgMetaTags(pageData, ctx)
  addJsonLd(pageData, ctx)
  addRssLinks(pageData, ctx)
  addHreflang(pageData, ctx) // Автоматически добавляет hreflang
}
```

## Преимущества

1. **SEO улучшения** - помогает поисковым системам понимать многоязычную структуру
2. **Автоматизация** - не требует ручного добавления метатегов
3. **Корректность** - генерирует правильные URL для всех языков
4. **Безопасность** - корректно обрабатывает ошибки и крайние случаи
5. **Производительность** - работает только с необходимыми страницами
6. **Соответствие стандартам** - не дублирует ссылки и правильно устанавливает x-default

## Тестирование

Функция протестирована на:

- ✅ Обычных постах
- ✅ Страницах с индексом
- ✅ Главных страницах
- ✅ Страницах без hostname
- ✅ Корневых страницах
- ✅ Страницах с одним языком
- ✅ Исключении root языка
- ✅ Отсутствии дублирования текущего языка
- ✅ Правильной установке x-default

## Поддержка

Функция полностью интегрирована в VitePress SLS Blog Template и готова к использованию без дополнительной настройки.

## Примеры вывода

### Для русской страницы `ru/index.md`:

```html
<link
  rel="alternate"
  hreflang="en-US"
  href="https://blog.p-libereco.org/en/index"
/>
<link
  rel="alternate"
  hreflang="x-default"
  href="https://blog.p-libereco.org/en/index"
/>
```

### Для английской страницы `en/index.md`:

```html
<link
  rel="alternate"
  hreflang="ru-RU"
  href="https://blog.p-libereco.org/ru/index"
/>
<link
  rel="alternate"
  hreflang="x-default"
  href="https://blog.p-libereco.org/ru/index"
/>
```
